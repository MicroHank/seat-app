# 教室座位表產生器 (Classroom Seat Generator) 使用說明

這是一個基於網頁的互動式座位表產生器，支援自訂教室佈局、學生名單管理、隨機抽籤以及 PDF 匯出功能。

## 🚀 快速開始

1.  **開啟網頁**：請使用瀏覽器開啟 `index.html` (需透過 Local Server 或 GitHub Pages)。
2.  **輸入活動名稱**：在上方導覽列輸入您的活動或課程名稱。
3.  **建立座位**：點擊「物件」，選擇建立「矩形座位」或「自建桌子」。
4.  **匯入名單**：點擊「名冊與切換」，建立班級並貼上/匯入學生名單。
5.  **自動排位**：建立座位時，系統會自動依序填入名單中的學生。

---

## 🛠 功能詳解

### 1. 模式切換 (右上方)
系統提供兩種操作模式，請依據需求切換：
*   **排桌子模式 (Desk Mode)**：
    *   **用途**：規劃教室空間、移動桌椅。
    *   **操作**：可以拖曳整組桌椅、調整矩陣大小、新增/刪除物件。
    *   **限制**：此模式下無法單獨移動學生座位。
*   **排座位模式 (Seat Mode)**：
    *   **用途**：調整學生座次。
    *   **操作**：拖曳「學生姓名」到另一個位置進行**交換**。
    *   **限制**：此模式下桌子位置被鎖定，無法移動。

### 2. 物件管理 (Objects)
點擊上方「物件」選單，可新增多種類型的教室物件：
*   **自建桌子**：支援圓桌 (Round) 與矩形桌 (Rect)，可設定每桌座位數與桌數。
*   **矩形座位 (Grid)**：快速建立 M x N 的矩陣座位表 (例如 5行 6列)。
*   **教室設施**：包含講台、白板、門、櫃子、窗戶、冷氣、投影幕、柱子、電扇、垃圾桶、佈告欄等。
    *   *提示*：所有物件皆可拖曳移動 (在排桌子模式下)。

### 3. 名冊管理 (Class Manager)
點擊「名冊與切換」按鈕：
*   **新增班級**：可以建立多個班級或單位的名冊資料庫。
*   **匯入名單**：支援 Excel (`.xlsx`, `.xls`) 匯入，或直接輸入。
*   **快速切換**：點擊「套用」即可將當前教室的學生名單替換為指定班級，系統會自動重新分配座位。

### 4. 隨機抽籤 (Lottery)
點擊「抽籤」按鈕開啟功能：
*   **一般抽籤**：隨機抽出 N 位人員。
*   **分組抽籤**：勾選「每桌各抽 1 人」，系統會從每一張桌子(群組)中各隨機挑選一位代表。
*   **排除機制**：預設會自動排除已經中獎過的人員 (可取消勾選)。
*   **音效**：抽籤過程與結果均有搭配音效提示。

### 5. 匯入與匯出 (Import / Export)
為了保存您的設計，系統提供完整的備份功能：
*   **匯出 (Export)**：下載 `.json` 檔案，包含完整的教室佈局、所有物件位置、以及目前的學生名單與班級資料庫。
*   **匯入 (Import)**：讀取 `.json` 檔案，完全還原之前的設計狀態。
*   **匯出 PDF**：將當前畫面截圖並轉存為 PDF 文件，方便列印或傳閱。(建議使用全螢幕模式以獲得最佳效果)

### 6. 參數設定 (Settings)
點擊「參數」按鈕，可自訂視覺細節：
*   **字體大小**：調整學生姓名的文字大小。
*   **座位尺寸**：分別調整矩陣座位、圓桌、矩形桌的座位顯示大小，避免太過擁擠。

---

## ⌨️ 常用操作技巧

| 動作 | 模式 | 說明 |
| :--- | :--- | :--- |
| **拖曳群組** | 排桌子 | 按住桌子或物件即可移動位置。 |
| **調整大小** | 排桌子 | 拖曳物件右下角的手柄，可縮放物件大小。 |
| **交換座位** | 排座位 | 將學生 A 拖曳到學生 B 的位置，兩人會交換。 |
| **移除座位** | 排桌子 | 在單一座位上按**右鍵**，可刪除該座位 (學生將暫時移出)。 |
| **刪除物件** | 排桌子 | 點擊物件上的 <i class="bi bi-x-lg"></i> 按鈕，可刪除整個物件。 |
| **複製物件** | 排桌子 | 點擊物件上的 <i class="bi bi-files"></i> 按鈕，可複製一份相同的物件。 |
| **全螢幕** | 通用 | 點擊右上角「全螢幕」按鈕，獲得更大的操作空間。 |

---

## ❓ 常見問題 (FAQ)

**Q: 重新整理網頁後，資料會不見嗎？**
A: 系統設有**自動存檔 (Auto-save)** 功能，重新整理後會自動還原最後一次的狀態。但建議編輯完成後，仍手動點擊「匯出」下載 JSON 備份最為保險。

**Q: 如何清除所有抽籤紀錄？**
A: 在抽籤視窗中，點擊「重置紀錄」按鈕即可。

**Q: 為什麼 PDF 匯出被卡一半？**
A: 建議開啟「全螢幕」模式後再進行匯出 PDF，確保畫面完整呈現。
